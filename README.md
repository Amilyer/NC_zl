# NC 自动化加工系统 (NC Auto-CAM System)

这是一个基于 NX Open (Python/C++) 的自动化 CAM 编程系统。旨在实现从原始设计文件（3D PRT + 2D DXF）到最终机床加工刀轨（Toolpath）的全自动化流程。

## 📋 项目简介

本项目通过一系列自动化脚本，解决传统 CAM 编程中繁琐的手动工作。系统能够自动拆分装配体、识别 2D 图纸加工特征、提取几何信息、并根据预设规则自动生成 NX 刀路。

**核心价值**：
*   **自动化**：减少人工点击，一键批量处理。
*   **标准化**：统一加工工艺和刀具参数。
*   **智能化**：自动匹配图纸与模型，识别加工特征。

---

## 🏗️ 系统架构与功能模块

系统采用分步流水线设计，主要包含以下核心模块：

### 1. 数据预处理 (Data Preprocessing)
*   **3D 模型拆分** (`Step 1`): 将整套模具/装配体 PRT 文件自动拆分为独立的单个零件文件。
*   **2D 图纸拆分** (`Step 2`): 解析 DXF 格式的 assembly 图纸，将其按零件拆分为独立的子图。
*   **图模匹配** (`Step 3`): 运用算法将 3D 零件与 2D 图纸进行智能配对，确保加工信息准确对应。

### 2. 几何处理与特征识别 (Geometry & Feature Extraction)
*   **DXF 转 PRT** (`Step 4`): 将 2D  DXF 线框投影并转换为 NX PRT 格式，以便在 3D 环境中作为辅助参考。
*   **模型清洗与钻孔** (`Step 4.5/5`): 自动处理模型，如创建钻孔几何体、清理多余图层。
*   **特征提取** (`Step 6/8`): 调用底层 DLL 接口，深度扫描模型几何表面，提取平面、孔、曲面等加工特征，并输出 CSV 数据报告。
*   **CAM 环境准备** (`Step 7`): 自动创建标准的 CAM 作业文件，加载工件、毛坯和辅助几何体到指定图层（如 Layer 20）。

### 3. 自动编程 (Automated CAM)
*   **刀轨生成** (`Step 9`): 核心模块。读取特征数据配置文件（JSON），自动为零件创建加工工序。支持多种策略：
    *   **面铣 (Face Milling)**: 顶部平面精加工。
    *   **行腔 (Cavity Milling)**: 开粗或去除大量材料。
    *   **等高/深度轮廓 (Z-Level)**: 侧壁和陡峭区域加工。
    *   **固定轮廓/爬面 (Fixed Contour)**: 复杂曲面精加工。
    *   **螺旋铣 (Spiral)**: 孔系加工。
*   **后处理 (Post Processing)**: (如有) 将刀路导出为机床可执行的 NC 代码。

---

## 📂 文件夹结构说明

项目采用标准化的输入输出流，数据流向清晰：

```text
C:\Projects\NC\output\
├── 00_Resources\          # [资源库] 
│   └── CSV_Reports\       # 存放所有中间过程生成的报表（配对结果、零件参数表等）
│
├── 01_Input\              # [输入源]
│   ├── 3D_PRT_Split\      # 拆分后的独立 3D 零件文件
│   └── 2D_DXF_Split\      # 拆分后的独立 2D 图纸文件
│
├── 02_Process\            # [过程文件]
│   ├── 1_DXF_to_PRT\      # 转换后的 2D 线框 PRT
│   ├── 2_Merged_PRT\      # 合并了 3D 模型与 2D 线框的中间文件
│   └── 3_Cleaned_PRT\     # 经过清洗、准备好进行特征识别的文件
│
├── 03_Analysis\           # [分析数据]
│   ├── Face_Info\         # 面信息提取结果
│   ├── Navigator_Reports\ # 导航器分析报告
│   └── Feature_Data\      # 最终识别出的特征数据 (CSV)
│
├── 04_PRT_with_Tool\      # [CAM 准备]
│   # 包含已加载刀具库、设置好坐标系 (MCS) 的 CAM 模板文件
│
├── 05_CAM\                # [自动编程结果]
│   ├── Toolpath_JSON\     # 用于驱动 CAM 生成的策略配置文件
│   └── Final_CAM_PRT\     # 最终生成的包含完整刀路的 PRT 文件 (可直接在 NX 中打开验证)
│
└── 06_Output\             # [最终交付]
    # 最终的 NC 代码或其他交付物
```

## 🚀 如何使用

通常情况下，您可以按顺序运行 `core/File preprocessing` 目录下的 `run_stepX.py` 脚本：

1.  **准备数据**: 将原始 PRT 和 DXF 放入 `output/01_Input` (或配置指定位置)。
2.  **执行预处理**: 依次运行 `run_step1` 至 `run_step4`。
3.  **特征识别**: 运行 `run_step6` 和 `run_step8` 提取数据。
4.  **生成刀路**: 运行 `run_step9`，系统将自动读取分析结果并在 `05_CAM/Final_CAM_PRT` 中生成带刀路的模型。

---
*注：本项目依赖 Siemens NX Open API，需在安装有 NX 软件的环境下运行。*
